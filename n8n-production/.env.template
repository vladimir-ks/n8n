# n8n Configuration
# ---------------
# These environment variables configure your n8n instance
# NOTE: Critical variables are also set in docker-compose.yaml environment section

# ======================================================
# CRITICAL CONFIGURATION (Do not change after initial setup)
# ======================================================

# Endpoint configuration: These must be set exactly as shown
# These values are critical for proper n8n v1.86+ functionality
# Critical: Must be "rest", not a URL
N8N_ENDPOINT_REST=rest
N8N_ENDPOINT_WEBHOOK=webhook         # Critical: Removes port from webhook URLs
N8N_ENDPOINT_WEBSOCKET=websocket     # Critical: Enables real-time connections

# Security
# IMPORTANT: This value must be identical across all environments
# to share credentials and encrypted data
N8N_ENCRYPTION_KEY=${N8N_ENCRYPTION_KEY}  # Critical: Must be consistent across environments

# ======================================================
# INSTANCE CONFIGURATION
# ======================================================

# Execution configuration
EXECUTIONS_PROCESS=main
N8N_RUNNERS_ENABLED=true

# Domain and access configuration (also set in docker-compose.yaml)
N8N_PROTOCOL=https
N8N_PORT=5678
N8N_HOST=${N8N_DOMAIN}
N8N_EDITOR_BASE_URL=https://${N8N_DOMAIN}

# Webhook URLs without port in the URL
N8N_WEBHOOK_URL=https://${N8N_DOMAIN}/webhook/
N8N_WEBHOOK_TEST_URL=https://${N8N_DOMAIN}/webhook-test/

# Production mode settings (also set in docker-compose.yaml)
NODE_ENV=production
N8N_DISABLE_PRODUCTION_MAIN_PROCESS=false

# ======================================================
# STORAGE & PERFORMANCE
# ======================================================

# Data storage configuration
N8N_DEFAULT_BINARY_DATA_MODE=filesystem
N8N_COMMUNITY_PACKAGES_ALLOW_TOOL_USAGE=true
N8N_ENFORCE_SETTINGS_FILE_PERMISSIONS=true

# Performance configuration
NODE_OPTIONS=--max-old-space-size=8192
NODE_VERSION=22.13.1

# ======================================================
# MODULES & EXTENSIONS
# ======================================================
# These variables control which Node.js modules can be used in n8n functions

# External modules (npm packages)
NODE_FUNCTION_ALLOW_EXTERNAL=jszip,lodash,ajv,moment,axios,crypto-js,validator,node-fetch,fast-xml-parser,playwright,cheerio

# Built-in Node.js modules
NODE_FUNCTION_ALLOW_BUILTIN=fs,crypto,path,http,https,os,stream,events,util,zlib,net,dns,timers
